<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Edit distance from string to string</a>
<ul>
<li><a href="#sec-1-1">Min Edit Distance (MED)</a></li>
<li><a href="#sec-1-2">Get the path</a></li>
<li><a href="#sec-1-3">Weighted MED</a></li>
</ul>
</li>
<li><a href="#sec-2">Align gene sequence</a>
<ul>
<li><a href="#sec-2-1">Test to myself</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Edit distance from string to string</h2>
<div class="outline-text-2" id="text-1">
<p>
The edit distance from string <code>str1</code> to string <code>str2</code> is used to
measure the cost of modifying <code>str1</code> to make it equals to <code>str2</code>. It
is used in spelling correction and coreference of named entities such
as "U.S.A" to "USA". 
</p>

<p>
Define three edit actions: insertion, deletion and substitution; the
edit distance is the weighted sum of number of operations. The costs
of insertion and deletion are usually set to one while the cost of
substitution is set to two since the substitution can be thought as a
combination of deletion and insertion.
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Min Edit Distance (MED)</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Min Edit Distance (MED) is computed through a dynamic programming
process, which is very similar to computing the maximum probability of
Hidden Markov model. MED is sometimes
called Levenshtein distance. See below the algorithm used to compute
the MED. 
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #859900;">def</span> <span style="color: #b58900;">med</span>(str1, str2):
    <span style="color: #6c71c4;">len1</span>, <span style="color: #6c71c4;">len2</span> = <span style="color: #6c71c4;">len</span>(str1)+1, <span style="color: #6c71c4;">len</span>(str2)+1
    <span style="color: #93a1a1; font-style: italic;"># </span><span style="color: #93a1a1; font-style: italic;">init the distance table</span>
    <span style="color: #6c71c4;">D</span>=[[0]*len2 <span style="color: #859900;">for</span> i <span style="color: #859900;">in</span> <span style="color: #6c71c4;">range</span>(len1)]
    <span style="color: #6c71c4;">D</span>[0]=<span style="color: #6c71c4;">range</span>(len2)
    <span style="color: #859900;">for</span> i <span style="color: #859900;">in</span> <span style="color: #6c71c4;">range</span>(len1):
        D[i][0]=i

    <span style="color: #859900;">for</span> i <span style="color: #859900;">in</span> <span style="color: #6c71c4;">range</span>(1, len1):
        <span style="color: #859900;">for</span> j <span style="color: #859900;">in</span> <span style="color: #6c71c4;">range</span>(1, len2):
            <span style="color: #6c71c4;">d1</span> = D[i-1][j]+1 <span style="color: #93a1a1; font-style: italic;"># </span><span style="color: #93a1a1; font-style: italic;">deletion</span>
            <span style="color: #6c71c4;">d2</span> = D[i][j-1]+1 <span style="color: #93a1a1; font-style: italic;"># </span><span style="color: #93a1a1; font-style: italic;">insertion</span>
            <span style="color: #6c71c4;">d3</span> = 2 <span style="color: #859900;">if</span> str1[i-1]!=str2[j-1] <span style="color: #859900;">else</span> 0 <span style="color: #93a1a1; font-style: italic;"># </span><span style="color: #93a1a1; font-style: italic;">substitution if not equal, 0 else.</span>
            D[i][j] = <span style="color: #6c71c4;">min</span>([d1, d2, d3])
    <span style="color: #859900;">return</span> D[len1][len2]
</pre>
</div>
<p>
One can interpret the update step as the cost of aligning the $i$th
character of <code>str1</code> to the $j$th character of <code>str2</code>. However, since
the strings change all the time, it is not easy to understand the
process. I think the step from <code>D[i-1][j]</code> to <code>D[i][j]</code> means when
\(i-1\) of <code>str1</code> is aligned to \(j\) of <code>str2</code>, we delete the \(i\) of
<code>str1</code>. The step from <code>D[i][j-1]</code> to <code>D[i][j]</code> means when \(i\) of
<code>str1</code> is aligned to \(j-1\) of <code>str2</code>, we insert a character so that
the \(j\) of <code>str2</code> is aligned from the state that \(i\) is aligned. The
step from <code>D[i-1][j-1]</code> to <code>D[i][j]</code> means, \(i-1\) and \(j-1\) is
aligned, we substitute \(i\) and \(j\) if they are different.
</p>

<p>
Note that even we say <code>D[i][j]</code> means the alignment of \(i\) and \(j\),
there are three concrete conditions: \(i\) is deleted, inserted a
character for \(j\), change the value of \(i\) to the value of \(j\). So it
should be explained by "after modification of the \(i\) in <code>str1</code>, the
modified part of <code>str1</code> is equal to the part of <code>str2</code> from start to
\(j\)". 
</p>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Get the path</h3>
<div class="outline-text-3" id="text-1-2">
<p>
It is very similar to finding the hidden units of Markov Machine. We
have to save the pointers from next state to last state during the
update. For example, <code>p[i][j]=(i-1,j)</code> when <code>d1</code> is the minimum.
</p>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">Weighted MED</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Replacing the weight of deletion, insertion and substitution by a
weight related to the character. Those weights are used in both
initialization and updating. The weights are computed from
statistics. For spelling errors, one can create a table that counts
the number of an editing action for each character (to each
character).
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Align gene sequence</h2>
<div class="outline-text-2" id="text-2">
<p>
Aligning gene sequence, searching overlap and max match pattern can
be seen as three variations of the MED problem by modifying the
initialization and updating values.
</p>

<p>
From the point of view of gene alignment, deletion can be seen as
inserting a blank space behind the \(j\) of <code>str2</code> and insertion can be
seen as a blank space being inserted to <code>str1</code>.
</p>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Test to myself</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Can you remember and implement the algorithms used to solve the three
questions mentioned in this section?
</p>
</div>
</div>
</div>
