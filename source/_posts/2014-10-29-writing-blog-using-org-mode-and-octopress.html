---
title: Writing Blog Using Org-mode and Octopress
layout: post
on: <2014-10-29 Wed>
categories: Geek
tags: Org-mode Octopress GitHub
CATEGORY: blog
---

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Octopress Installation</a>
<ul>
<li><a href="#sec-1-1">1.1. Installation of old version ruby with rbenv</a></li>
<li><a href="#sec-1-2">1.2. Setup the octopress</a>
<ul>
<li><a href="#sec-1-2-1">1.2.1. Setup</a></li>
<li><a href="#sec-1-2-2">1.2.2. Common usage</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<p>
After the installation  and the configuration of jekyll along with
the org-mode. I tried to find some configurations to facilitate the
creation of org files (create file with date in front of file name,
insert heads, etc.) I did not realize the existence of relative
emacs packages in elpa and asked google for solutions. My
inefficient search key-words let the google returns undesired
answer: the <b>octopress</b>. Octopress is based on the jekyll, but
provide richer blog settings. Finally, I migrated to octopress and
use it to manager my github pages.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><a href="xiaoliuai.github.io{{ page.url }}"><span class="section-number-2">1</span> Octopress Installation</a></h2>
<div class="outline-text-2" id="text-1">
<p>
Installation of octopress is little complex since it requires low
version ruby.
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Installation of old version ruby with rbenv</h3>
<div class="outline-text-3" id="text-1-1">
<p>
You can following the instructions on the <a href="http://octopress.org/docs/setup/rbenv">official manual</a>.
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5859b7;">cd</span> <span style="color: #81908f; font-style: italic;"># </span><span style="color: #81908f; font-style: italic;">go to home</span>
git clone git://github.com/sstephenson/rbenv.git .rbenv
git clone git://github.com/sstephenson/ruby-build.git .rbenv/plugins/ruby-build
</pre>
</div>
<p>
Add two lines into the end of shell profile (.zshrc in my case).
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5859b7;">export</span> <span style="color: #5859b7;">PATH</span>=$<span style="color: #5859b7;">HOME</span>/.rbenv/bin:$<span style="color: #5859b7;">PATH</span>
<span style="color: #5859b7;">eval</span> <span style="color: #259185;">"$(rbenv init -)"</span>
</pre>
</div>
<p>
Then reload the profile by <code>source ~/.zshrc</code> or resume the
terminal.
The installation of rbenv and ruby-build can be replaced by
</p>
<div class="org-src-container">

<pre class="src src-sh">brew update
brew install rbenv
brew install ruby-build
</pre>
</div>
<p>
Attention: the shell profile must be modified with both
installation methods.
</p>

<p>
Then install ruby 1.9.3, which is required by octopress.
</p>
<div class="org-src-container">

<pre class="src src-sh">rbenv install 1.9.3-p0
rbenv local 1.9.3-p0
rbenv rehash
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Setup the octopress</h3>
<div class="outline-text-3" id="text-1-2">
<p>
My setup experience is basically the same with the <a href="http://octopress.org/docs/setup/">official
manual</a>. However, after the installation, I replaced the octopress
directory to <code>~/WorkSpace/xiaoliuai.github.io</code> because it actually
becomes the repository of my github pages (<b>magnificent!</b>). So I
suggest to clone the octopress git repository into the directory
with the same name of the repository of your github pages at the
beginning.
</p>
</div>

<div id="outline-container-sec-1-2-1" class="outline-4">
<h4 id="sec-1-2-1"><span class="section-number-4">1.2.1</span> Setup</h4>
<div class="outline-text-4" id="text-1-2-1">
<ul class="org-ul">
<li>Copy octopress repository

<p>
(_I suggest to clone shallow copy with option_ <code>depth</code>)
</p>
<div class="org-src-container">

<pre class="src src-sh">git clone git://github.com/imathis/octopress.git octopress
<span style="color: #5859b7;">cd</span> octopress
</pre>
</div>
</li>
<li>Install dependencies
<div class="org-src-container">

<pre class="src src-sh">gem install bundler
rbenv rehash    <span style="color: #81908f; font-style: italic;"># </span><span style="color: #81908f; font-style: italic;">If you use rbenv, rehash to be able to run the bundle command</span>
bundle install
</pre>
</div>
</li>
<li>Install the default theme

<p>
(_I suggest to ignore this step and install the 3rd-party theme
directly_)
</p>
<div class="org-src-container">

<pre class="src src-sh">rake install
</pre>
</div>
</li>
<li>Install the 3rd-party theme (optional)
</li>
<li>Add 3rd-party tools (optional)
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-2-2" class="outline-4">
<h4 id="sec-1-2-2"><span class="section-number-4">1.2.2</span> Common usage</h4>
<div class="outline-text-4" id="text-1-2-2">
<ul class="org-ul">
<li>Local site

<p>
The octopress puts the generated web site, including the pages,
layouts, images, etc. into the <code>_deploy</code> folder. The <code>source</code>
folder contains all the source files used to generate the site,
including the layout HTML files, Java-scripts, style-sheets,
etc. It can be seemed as a hyper <code>_posts</code> folder that contains
source files more than blog HTML files. The familiar <code>_posts</code>
folder used in jekyll is under this folder. Let's <a href="http://octopress.org/docs/blogging/">start blogging</a>.
</p>

<p>
First, go into the octopress folder, type <code>rake
      new_post["title"]</code>, octopress will ask you to give a blog tile,
then creates a <code>markdown</code> file into the <code>_posts</code> folder with
jekyll format (concatenate date and the title as the file name).
</p>
<div class="org-src-container">

<pre class="src src-sh">rake new_post[<span style="color: #259185;">"My first blog"</span>]
<span style="color: #81908f; font-style: italic;"># </span><span style="color: #81908f; font-style: italic;">create source/_posts/2014-10-28-my-first-blog.markdown</span>
</pre>
</div>
<p>
This file should be edited respect to the jekyll protocol.
</p>

<p>
Second, ran <code>rake generate</code> to generate the site in <code>_deploy</code>
and then ran <code>rake preview</code> to mount a web-server at
<a href="http://localhost:4000">http://localhost:4000</a>.
</p>
</li>

<li>Deploying to Github Pages

<p>
Octopress integrated commands to let you deploy the generated
site to the github.
</p>
<div class="org-src-container">

<pre class="src src-sh">rake setup_github_pages
</pre>
</div>
<p>
This command will ask you for a URL of the Github repo, then it
will store your Github pages repository URL as the <i>origin</i>
remote and change the octopress remote to <i>octopress</i>. The
directory of octopress becomes the repository of the <b>source</b>
branch of the origin remote (your Github Pages repo). The
<code>_deploy</code> directory, which contains the generated site, becomes
the <b>master</b> branch of the origin remote.
Run command:
</p>
<div class="org-src-container">

<pre class="src src-sh">rake deploy
</pre>
</div>
<p>
will push the generated site in <code>_deploy</code> to the master branch
of the origin remote.
To keep your settings and sources tracked, run
</p>
<div class="org-src-container">

<pre class="src src-sh">git add .
git commit -m<span style="color: #259185;">'Your message'</span>
git push origin source
</pre>
</div>
<p>
to push the contents in octopress directory to the source branch
of the origin remote.
</p>

<p>
<span class="underline">One thing confusing is that one repository (master branch) is</span>
<span class="underline">under another repository. But the directory <code>_deploy</code> is in the</span>
<span class="underline"><code>gitignore</code> of source branch, hence solve the self-contain
problem.</span>
</p>
</li>
</ul>

<p>

</p>
</div>
</div>
</div>
</div>
